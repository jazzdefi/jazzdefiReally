{"ast":null,"code":"var _jsxFileName = \"/home/drab/Documents/jazzdefi/src/views/Profile/components/EditProfileModal/ChangeProfilePicView.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { Button, Skeleton, Text } from \"@mozartfinance/uikit\";\nimport { useWeb3React } from \"@web3-react/core\";\nimport { useDispatch } from \"react-redux\";\nimport nftList from \"config/constants/nfts\";\nimport { useProfile, useToast } from \"state/hooks\";\nimport useI18n from \"hooks/useI18n\";\nimport { fetchProfile } from \"state/profile\";\nimport useGetWalletNfts from \"hooks/useGetWalletNfts\";\nimport useApproveConfirmTransaction from \"hooks/useApproveConfirmTransaction\";\nimport { usePancakeRabbits, useProfile as useProfileContract } from \"hooks/useContract\";\nimport { getPancakeProfileAddress, getPancakeRabbitsAddress } from \"utils/addressHelpers\";\nimport SelectionCard from \"../SelectionCard\";\nimport ApproveConfirmButtons from \"../ApproveConfirmButtons\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst ChangeProfilePicPage = ({\n  onDismiss\n}) => {\n  _s();\n\n  const [tokenId, setTokenId] = useState(null);\n  const TranslateString = useI18n();\n  const {\n    isLoading,\n    nfts: nftsInWallet\n  } = useGetWalletNfts();\n  const dispatch = useDispatch();\n  const {\n    profile\n  } = useProfile();\n  const pancakeRabbitsContract = usePancakeRabbits();\n  const profileContract = useProfileContract();\n  const {\n    account\n  } = useWeb3React();\n  const {\n    toastSuccess\n  } = useToast();\n  const {\n    isApproving,\n    isApproved,\n    isConfirmed,\n    isConfirming,\n    handleApprove,\n    handleConfirm\n  } = useApproveConfirmTransaction({\n    onApprove: () => {\n      return pancakeRabbitsContract.methods.approve(getPancakeProfileAddress(), tokenId).send({\n        from: account\n      });\n    },\n    onConfirm: () => {\n      if (!profile.isActive) {\n        return profileContract.methods.reactivateProfile(getPancakeRabbitsAddress(), tokenId).send({\n          from: account\n        });\n      }\n\n      return profileContract.methods.updateProfile(getPancakeRabbitsAddress(), tokenId).send({\n        from: account\n      });\n    },\n    onSuccess: async () => {\n      // Re-fetch profile\n      await dispatch(fetchProfile(account));\n      toastSuccess(\"Profile Updated!\");\n      onDismiss();\n    }\n  });\n  const bunnyIds = Object.keys(nftsInWallet).map(nftWalletItem => Number(nftWalletItem));\n  const walletNfts = nftList.filter(nft => bunnyIds.includes(nft.bunnyId));\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Text, {\n      as: \"p\",\n      color: \"textSubtle\",\n      mb: \"24px\",\n      children: TranslateString(999, \"Choose a new Collectible to use as your profile pic.\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), isLoading ? /*#__PURE__*/_jsxDEV(Skeleton, {\n      height: \"80px\",\n      mb: \"16px\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }, this) : walletNfts.map(walletNft => {\n      const [firstTokenId] = nftsInWallet[walletNft.bunnyId].tokenIds;\n      return /*#__PURE__*/_jsxDEV(SelectionCard, {\n        name: \"profilePicture\",\n        value: firstTokenId,\n        image: `/images/nfts/${walletNft.images.md}`,\n        isChecked: firstTokenId === tokenId,\n        onChange: value => setTokenId(parseInt(value, 10)),\n        disabled: isApproving || isConfirming || isConfirmed,\n        children: /*#__PURE__*/_jsxDEV(Text, {\n          bold: true,\n          children: walletNft.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 15\n        }, this)\n      }, walletNft.bunnyId, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }, this);\n    }), !isLoading && walletNfts.length === 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Text, {\n        as: \"p\",\n        color: \"textSubtle\",\n        mb: \"16px\",\n        children: TranslateString(999, \"Sorry! You don’t have any eligible Collectibles in your wallet to use!\")\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Text, {\n        as: \"p\",\n        color: \"textSubtle\",\n        mb: \"24px\",\n        children: TranslateString(999, \"Make sure you have a Pancake Collectible in your wallet and try again!\")\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), /*#__PURE__*/_jsxDEV(ApproveConfirmButtons, {\n      isApproveDisabled: isConfirmed || isConfirming || isApproved || tokenId === null,\n      isApproving: isApproving,\n      isConfirmDisabled: !isApproved || isConfirmed || tokenId === null,\n      isConfirming: isConfirming,\n      onApprove: handleApprove,\n      onConfirm: handleConfirm\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"text\",\n      width: \"100%\",\n      onClick: onDismiss,\n      disabled: isApproving || isConfirming,\n      children: TranslateString(999, \"Close Window\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(ChangeProfilePicPage, \"oMFyEGMjMrGQgUbmOoT5ZL9dyU8=\", false, function () {\n  return [useI18n, useGetWalletNfts, useDispatch, useProfile, usePancakeRabbits, useProfileContract, useWeb3React, useToast, useApproveConfirmTransaction];\n});\n\n_c = ChangeProfilePicPage;\nexport default ChangeProfilePicPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChangeProfilePicPage\");","map":{"version":3,"sources":["/home/drab/Documents/jazzdefi/src/views/Profile/components/EditProfileModal/ChangeProfilePicView.tsx"],"names":["React","useState","Button","Skeleton","Text","useWeb3React","useDispatch","nftList","useProfile","useToast","useI18n","fetchProfile","useGetWalletNfts","useApproveConfirmTransaction","usePancakeRabbits","useProfileContract","getPancakeProfileAddress","getPancakeRabbitsAddress","SelectionCard","ApproveConfirmButtons","ChangeProfilePicPage","onDismiss","tokenId","setTokenId","TranslateString","isLoading","nfts","nftsInWallet","dispatch","profile","pancakeRabbitsContract","profileContract","account","toastSuccess","isApproving","isApproved","isConfirmed","isConfirming","handleApprove","handleConfirm","onApprove","methods","approve","send","from","onConfirm","isActive","reactivateProfile","updateProfile","onSuccess","bunnyIds","Object","keys","map","nftWalletItem","Number","walletNfts","filter","nft","includes","bunnyId","walletNft","firstTokenId","tokenIds","images","md","value","parseInt","name","length"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport {\n  Button,\n  InjectedModalProps,\n  Skeleton,\n  Text,\n} from \"@mozartfinance/uikit\";\nimport { useWeb3React } from \"@web3-react/core\";\nimport { useDispatch } from \"react-redux\";\nimport nftList from \"config/constants/nfts\";\nimport { useProfile, useToast } from \"state/hooks\";\nimport useI18n from \"hooks/useI18n\";\nimport { fetchProfile } from \"state/profile\";\nimport useGetWalletNfts from \"hooks/useGetWalletNfts\";\nimport useApproveConfirmTransaction from \"hooks/useApproveConfirmTransaction\";\nimport {\n  usePancakeRabbits,\n  useProfile as useProfileContract,\n} from \"hooks/useContract\";\nimport {\n  getPancakeProfileAddress,\n  getPancakeRabbitsAddress,\n} from \"utils/addressHelpers\";\nimport SelectionCard from \"../SelectionCard\";\nimport ApproveConfirmButtons from \"../ApproveConfirmButtons\";\n\ntype ChangeProfilePicPageProps = InjectedModalProps;\n\nconst ChangeProfilePicPage: React.FC<ChangeProfilePicPageProps> = ({\n  onDismiss,\n}) => {\n  const [tokenId, setTokenId] = useState(null);\n  const TranslateString = useI18n();\n  const { isLoading, nfts: nftsInWallet } = useGetWalletNfts();\n  const dispatch = useDispatch();\n  const { profile } = useProfile();\n  const pancakeRabbitsContract = usePancakeRabbits();\n  const profileContract = useProfileContract();\n  const { account } = useWeb3React();\n  const { toastSuccess } = useToast();\n  const {\n    isApproving,\n    isApproved,\n    isConfirmed,\n    isConfirming,\n    handleApprove,\n    handleConfirm,\n  } = useApproveConfirmTransaction({\n    onApprove: () => {\n      return pancakeRabbitsContract.methods\n        .approve(getPancakeProfileAddress(), tokenId)\n        .send({ from: account });\n    },\n    onConfirm: () => {\n      if (!profile.isActive) {\n        return profileContract.methods\n          .reactivateProfile(getPancakeRabbitsAddress(), tokenId)\n          .send({ from: account });\n      }\n\n      return profileContract.methods\n        .updateProfile(getPancakeRabbitsAddress(), tokenId)\n        .send({ from: account });\n    },\n    onSuccess: async () => {\n      // Re-fetch profile\n      await dispatch(fetchProfile(account));\n      toastSuccess(\"Profile Updated!\");\n\n      onDismiss();\n    },\n  });\n  const bunnyIds = Object.keys(nftsInWallet).map((nftWalletItem) =>\n    Number(nftWalletItem)\n  );\n  const walletNfts = nftList.filter((nft) => bunnyIds.includes(nft.bunnyId));\n\n  return (\n    <>\n      <Text as=\"p\" color=\"textSubtle\" mb=\"24px\">\n        {TranslateString(\n          999,\n          \"Choose a new Collectible to use as your profile pic.\"\n        )}\n      </Text>\n      {isLoading ? (\n        <Skeleton height=\"80px\" mb=\"16px\" />\n      ) : (\n        walletNfts.map((walletNft) => {\n          const [firstTokenId] = nftsInWallet[walletNft.bunnyId].tokenIds;\n\n          return (\n            <SelectionCard\n              name=\"profilePicture\"\n              key={walletNft.bunnyId}\n              value={firstTokenId}\n              image={`/images/nfts/${walletNft.images.md}`}\n              isChecked={firstTokenId === tokenId}\n              onChange={(value: string) => setTokenId(parseInt(value, 10))}\n              disabled={isApproving || isConfirming || isConfirmed}\n            >\n              <Text bold>{walletNft.name}</Text>\n            </SelectionCard>\n          );\n        })\n      )}\n      {!isLoading && walletNfts.length === 0 && (\n        <>\n          <Text as=\"p\" color=\"textSubtle\" mb=\"16px\">\n            {TranslateString(\n              999,\n              \"Sorry! You don’t have any eligible Collectibles in your wallet to use!\"\n            )}\n          </Text>\n          <Text as=\"p\" color=\"textSubtle\" mb=\"24px\">\n            {TranslateString(\n              999,\n              \"Make sure you have a Pancake Collectible in your wallet and try again!\"\n            )}\n          </Text>\n        </>\n      )}\n      <ApproveConfirmButtons\n        isApproveDisabled={\n          isConfirmed || isConfirming || isApproved || tokenId === null\n        }\n        isApproving={isApproving}\n        isConfirmDisabled={!isApproved || isConfirmed || tokenId === null}\n        isConfirming={isConfirming}\n        onApprove={handleApprove}\n        onConfirm={handleConfirm}\n      />\n      <Button\n        variant=\"text\"\n        width=\"100%\"\n        onClick={onDismiss}\n        disabled={isApproving || isConfirming}\n      >\n        {TranslateString(999, \"Close Window\")}\n      </Button>\n    </>\n  );\n};\n\nexport default ChangeProfilePicPage;\n"]},"metadata":{},"sourceType":"module"}